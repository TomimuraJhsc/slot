<div class="tabs-container">
    <!-- ã‚¿ãƒ–ãƒœã‚¿ãƒ³ -->
    <div class="tab-buttons">
        <button class="tab-button <%= 'active' if params[:active_tab] == 'list' || params[:active_tab].blank? %>" onclick="switchTab('list')" data-tab="list">ğŸ“‹ ä¸€è¦§</button>
        <button class="tab-button <%= 'active' if params[:active_tab] == 'machine-stats' %>" onclick="switchTab('machine-stats')" data-tab="machine-stats">ğŸ“Š æ©Ÿç¨®å˜ä½</button>
        <button class="tab-button <%= 'active' if params[:active_tab] == 'daily-summary' %>" onclick="switchTab('daily-summary')" data-tab="daily-summary">ğŸ“… æ—¥åˆ¥é›†è¨ˆ</button>
        <button class="tab-button <%= 'active' if params[:active_tab] == 'map' %>" onclick="switchTab('map')" data-tab="map">ğŸ—ºï¸ ãƒãƒƒãƒ—</button>
    </div>

    <!-- ä¸€è¦§ã‚¿ãƒ– -->
    <div id="tab-list" class="tab-content <%= 'active' if params[:active_tab] == 'list' || params[:active_tab].blank? %>">
        <%= render 'tab_list' %>
    </div>

    <!-- æ©Ÿç¨®å˜ä½ã‚¿ãƒ– -->
    <div id="tab-machine-stats" class="tab-content <%= 'active' if params[:active_tab] == 'machine-stats' %>">
        <%= render 'tab_machine_stats' %>
    </div>

    <!-- æ—¥åˆ¥é›†è¨ˆã‚¿ãƒ– -->
    <div id="tab-daily-summary" class="tab-content <%= 'active' if params[:active_tab] == 'daily-summary' %>">
        <%= render 'tab_daily_summary' %>
    </div>

    <!-- ãƒãƒƒãƒ—ã‚¿ãƒ– -->
    <div id="tab-map" class="tab-content <%= 'active' if params[:active_tab] == 'map' %>">
        <%= render 'tab_map' %>
    </div>
</div>

<script>
    // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ™‚ã«hidden inputã®å€¤ã‚’æ›´æ–°
    function switchTab(tabName) {
        // ã™ã¹ã¦ã®ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’éè¡¨ç¤º
        const contents = document.querySelectorAll(".tab-content");
        contents.forEach((content) => {
            content.classList.remove("active");
        });

        // ã™ã¹ã¦ã®ã‚¿ãƒ–ãƒœã‚¿ãƒ³ã‚’éã‚¢ã‚¯ãƒ†ã‚£ãƒ–
        const buttons = document.querySelectorAll(".tab-button");
        buttons.forEach((button) => {
            button.classList.remove("active");
        });

        // é¸æŠã•ã‚ŒãŸã‚¿ãƒ–ã‚’è¡¨ç¤º
        const selectedContent = document.getElementById("tab-" + tabName);
        if (selectedContent) {
            selectedContent.classList.add("active");
        }

        // é¸æŠã•ã‚ŒãŸãƒœã‚¿ãƒ³ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–
        const selectedButton = event?.target;
        if (selectedButton) {
            selectedButton.classList.add("active");
        }

        // hidden inputã®å€¤ã‚’æ›´æ–°ï¼ˆå…¨ã¦ã®ãƒ•ã‚©ãƒ¼ãƒ ã§ï¼‰
        const activeTabInputs = document.querySelectorAll('#active-tab');
        activeTabInputs.forEach(input => {
            input.value = tabName;
        });

        // ãƒãƒƒãƒ—ã‚¿ãƒ–ã®å ´åˆã€åˆæœŸåŒ–ã‚’å®Ÿè¡Œ
        if (tabName === "map" && window.currentMapId) {
            setTimeout(() => {
                if (typeof initializeMap === 'function') {
                    initializeMap(window.hallId, window.currentMapId, window.currentDate);
                }
            }, 100);
        }
    }
</script>